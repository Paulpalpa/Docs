---
sidebar_position: 2
---

# Three.js 基础知识

Three.js 是一款运行在浏览器中的 3D 引擎

## Three.js 中的 3D 场景基础知识

1. 场景(Scene)：是物体、光源等元素的容器，可以配合 chrome 插件使用，抛出 window.scene 即可实时调整 obj 的信息和材质信息。
2. 相机（Camera）：场景中的相机，代替人眼去观察，场景中只能添加一个，一般常用的是透视相机（PerspectiveCamera）
3. 物体对象（Mesh）：包括二维物体（点、线、面）、三维物体，模型等等
4. 光源（Light）：场景中的光照，如果不添加光照场景将会是一片漆黑，包括全局光、平行光、点光源等
5. 渲染器（Renderer）:场景的渲染方式，如 webGL\canvas2D\Css3D。
6. 控制器(Control): 可通过键盘、鼠标控制相机的移动

## 相机

Three.js 中我们常用的有两种类型的相机：正交（orthographic）相机、透视（perspective）相机。一般情况下为了模拟人眼我们都是使用透视相机； 正交镜头的特点是，物品的渲染尺寸与它距离镜头的远近无关。也就是说在场景中移动一个物体，其大小不会变化。正交镜头适合 2D 游戏。 透视镜头则是模拟人眼的视觉特点，距离远的物体显得更小。透视镜头通常更适合 3D 渲染。

| 参数   | 说明                                                                                          |
| ------ | --------------------------------------------------------------------------------------------- |
| fov    | 视野角度，从镜头可以看到的场景的部分。通常 3D 游戏的 FOV 取值在 60-90 度之间较好的默认值为 60 |
| aspect | 渲染区域的纵横比。较好的默认值为 window.innerWidth/window.innerHeight                         |
| near   | 视野角度，从镜头可以看到的场景的部分。通常 3D 游戏的 FOV 取值在 60-90 度之间较好的默认值为 60 |
| far    | 远离镜头的距离                                                                                |

![这是图片](/img/camera.png "Magic Gardens")

## 灯光

在 Three.js 中光源是必须的，如果一个场景你不设置灯光那么世界将会是一片漆黑。Three.js 内置了多种光源以满足特定场景的需要。大家可以根据自己的项目需要来选择何种灯光

| 参数             | 说明                                                                                                              |
| ---------------- | ----------------------------------------------------------------------------------------------------------------- |
| AmbientLight     | 环境光，其颜色均匀的应用到场景及其所有对象上,这种光源为场景添加全局的环境光。这种光没有特定的方向，不会产生阴影。 |
| PointLight       | 3D 空间中的一个点光源，向所有方向发出光线。                                                                       |
| SpotLight        | 产生圆锥形光柱的聚光灯，台灯、天花板射灯通常都属于这类光源,这种光源的使用场景最多，特别是在你需要阴影效果的时候。 |
| DirectionalLight | 类似太阳那样的光源，它不会随着距离而变暗，所有被照耀的地方获得相同的光照强度。                                    |
| HemisphereLight  | 特殊光源，用于创建户外自然的光线效果，此光源模拟物体表面反光效果、微弱发光的天空,模拟穹顶的微弱发光效果           |
| AreaLight        | 面光源，指定一个发光的区域                                                                                        |
| LensFlare        | 不是光源，用于给光源添加镜头光晕效果                                                                              |

## Mesh

在计算机的世界里，一条弧线是由有限个点构成的有限条线段连接得到的。当线段数量越多，长度就越短，当达到你无法察觉这是线段时，一条平滑的弧线就出现了。 计算机的三维模型也是类似的。只不过线段变成了平面，普遍用三角形组成的网格来描述。我们把这种模型称之为 Mesh 模型。 在 threeJs 的世界中，材质(Material)+几何体(Geometry)就是一个 mesh。设置其 name 属性可以通过 scene.getObjectByName(name)获取该物体对象;Geometry 就好像是骨架，材质则类似于皮肤，对于材质和几何体的分类见下表格

| 材质                 | 说明                                                                      |
| -------------------- | ------------------------------------------------------------------------- |
| MeshBasicMaterial    | 基本的材质，显示为简单的颜色或者显示为线框。不考虑光线的影响              |
| MeshDepthMaterial    | 使用简单的颜色，但是颜色深度和距离相机的远近有关                          |
| MeshNormalMaterial   | 基于面 Geometry 的法线（normals）数组来给面着色                           |
| MeshFacematerial     | 容器，允许为 Geometry 的每一个面指定一个材质                              |
| MeshLambertMaterial  | 考虑光线的影响，哑光材质                                                  |
| MeshPhongMaterial    | 考虑光线的影响，光泽材质                                                  |
| ShaderMaterial       | 允许使用自己的着色器来控制顶点如何被放置、像素如何被着色                  |
| LineBasicMaterial    | 用于 THREE.Line 对象，创建彩色线条                                        |
| LineDashMaterial     | 用于 THREE.Line 对象，创建虚线条                                          |
| RawShaderMaterial    | 仅和 THREE.BufferedGeometry 联用，优化静态 Geometry（顶点、面不变）的渲染 |
| SpriteCanvasMaterial | 在针对单独的点进行渲染时用到                                              |
| SpriteMaterial       | 在针对单独的点进行渲染时用到                                              |
| PointCloudMaterial   | 在针对单独的点进行渲染时用到                                              |

## 模型加载

一般来讲我们的场景中不可能都是一些奇奇怪怪的形状，或多或少项目中都会用到一些外部的模型资源，不如动物啊，装饰物啊什么的，再加上一些动画，这样整个场景更加显得生动，那么 Three.js 中我们可以通过哪些方式来加载外部的模型资源呢？加载外部模型，是通过 Three.js 加载器（Loader）实现的。加载器把文本/二进制的模型文件转化为 Three.js 对象结构。 每个加载器理解某种特定的文件格式。

| 格式           | 说明                                                                                                                               |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| JSON           | Three.js 自定义的、基于 JSON 的格式。可以声明式的定义一个 Geometry 或者 Scene.利用该格式，你可以方便的重用复杂的 Geometry 或 Scene |
| OBJ / MTL      | OBJ 是 Wavefront 开发的一种简单 3D 格式，此格式被广泛的支持，用于定义 Geometry，MTL 用于配合 OBJ，它指定 OBJ 使用的材质            |
| Collada（dae） | 基于 XML 的格式，被大量 3D 应用程序、渲染引擎支持                                                                                  |
| STL            | STereoLithography 的简写，在快速原型领域被广泛使用。Three.js 提供了 STLExporter.js，使用它可以把 Three.js 模型导出为 STL 格式      |
| CTM            | openCTM 定义的格式，以紧凑的格式存储基于三角形的 Mesh                                                                              |
| VTK            | Visualization Toolkit 定义的格式，用于声明顶点和面。此格式有二进制/ASCII 两种变体，Three.js 仅支持 ASCII 变体                      |
| AWD            | 3D 场景的二进制格式，主要被 away3d 引擎使用，Three.js 不支持 AWD 压缩格式                                                          |
| Assimp         | 开放资产导入库（Open asset import library）是导入多种 3D 模型的标准方式。使用该 Loader 你可以导入多种多样的 3D 模型格式            |
| VRML           | 虚拟现实建模语言（Virtual Reality Modeling Language）是一种基于文本的格式                                                          |
| Babylon        | 游戏引擎 Babylon 的私有格式                                                                                                        |
| PLY            | 常用于存储来自 3D 扫描仪的信息                                                                                                     |
